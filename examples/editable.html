<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>An editable code-prettify example</title>

<script type="text/javascript" src="../src/run_prettify.js?autoload=true&amp;skin=sunburst"></script>
<script type="text/javascript" src="../src/lang-ex.js"></script>
<style type="text/css">
/* making the interpunction easier to see */
pre .pun{ color: yellow; }
</style>
</head>

<body>
<h1>Editable Example</h1>
<p>
Unfocus the textarea or click on the button to reload the prettified contents.
</p>
<pre style="background-color:black">
  <span class="str">string</span>
  <span class="kwd">keyword</span>
  <span class="com">comment</span>
  <span class="typ">type</span>
  <span class="lit">literal</span>
  <span class="pun">punctuation</span> <span class="pln">- normally the same colour as plaintext, now yellow for visibility</span>
  <span class="pln">plaintext</span>
  <span class="tag">html tag</span>
  <span class="atn">attribute name</span>
  <span class="atv">attribute value</span>
  <span class="dec">decimal</span>
</pre>
<!-- Language hints can be put in XML application directive style comments. -->
<?prettify lang=ex linenums=false?>
<pre class="prettyprint" id="code"></pre>
<textarea id="source" onchange="reloadPre();" placeholder="put your code here" rows="30" cols="120" style="font-family:monospace">
defmodule Foo.Bar.Baz do
  # one-line comment

  use Foo.Bar4.Baz
  alias Foo.Bar.Baz
  alias __MODULE__, as: This
  require Foo.Bar.Baz

  @default_token_size 64_000

  @moduledoc """
  Multiline moduledoc
  """

  @spec token(length :: integer) :: String.t

  def token(size \\ @default_token_size), do: random_string(size)

  def _not_exported(), do: 0xFF + 0xF_F - 0xff

  def other_function(foo, bar) do
    float = 3.14
    float = 1_3.1_4
    str = "string with #{float} interpolation" &lt;&gt; " some more"
    mstr = "multiline \"
    string"
    charlist = 'some\'chars'
    ls = [1 | [2, 3]]
    map = %{"baz" => "ban"}
    map = %{foo: :bar, "yes, this compiles": :"also an atom"}
    :erlang.time()
    case {foo, bar} do
      {1, 2} ->
        3
      _something_else -> :error
      _ -> :"this won't match"
    end
    # sigils
    ~r/hello/
    ~r|hello|
    ~r"hello"
    ~r'hello'
    ~r(hello)
    ~r[hello]
    ~r{hello}
    ~r&lt;hello&gt;
  end
end
</textarea>
<br />
<button onclick="reloadPre();">Reload pretty code</button>
<script type="text/javascript">//<![CDATA[

function htmlEscape(s) {
  return s
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;');
}

function populatePreFromTextarea() {
  var source = htmlEscape(document.getElementById("source").value)
  document.getElementById("code").innerHTML = source;
}

function reloadPre() {
  populatePreFromTextarea();

  // forcing the reprint
  document.getElementById("code").className = "prettyprint"
  PR.prettyPrint();
}

(function () {
  populatePreFromTextarea();
})();
//]]>
</script>
</body>
</html>
